fill = exp_cut)) +
scale_fill_brewer("Expected deaths", palette="RdBu", direction=-1) +
theme(line=element_blank(),
axis.text=element_blank(),
axis.title=element_blank()) +
coord_equal()
#save the map
ggsave("ohio_map_exp_ggplot.pdf", width=8, height=8)
plot(expected_ct_map,
border='blue',
lwd=1)
#set breakpoints for plotting
num_bins <- 8
quants <- round(quantile(ohio_map@data$smr, seq(0,1,length.out=num_bins)),2)
ohio_map@data$smr_cut <- cut(ohio_map@data$smr, breaks=c(quants, Inf), include.lowest=TRUE, right=FALSE)
ohio_df <- tidy(ohio_map)
ohio_map$polyID <- sapply(slot(ohio_map, "polygons"), function(x) slot(x, "ID"))
ohio_df <- merge(ohio_df, ohio_map, by.x="id", by.y="polyID")
smr_ct_map <- ggplot() +
geom_polygon(
data=ohio_df,
aes(x=long, y=lat, group=group,
fill = smr_cut)) +
scale_fill_brewer("SMR", palette="RdBu", direction=-1) +
theme(line=element_blank(),
axis.text=element_blank(),
axis.title=element_blank()) +
coord_equal()
#save the map
ggsave("ohio_map_smr_ggplot.pdf", width=8, height=8)
plot(smr_ct_map,
border='blue',
lwd=1)
#set breakpoints for plotting
num_bins <- 8
quants <- round(quantile(ohio_map@data$Exp, seq(0,1,length.out=num_bins)),2)
ohio_map@data$exp_cut <- cut(ohio_map@data$Exp, breaks=c(quants, Inf), include.lowest=TRUE, right=FALSE)
ohio_df <- tidy(ohio_map)
ohio_map$polyID <- sapply(slot(ohio_map, "polygons"), function(x) slot(x, "ID"))
ohio_df <- merge(ohio_df, ohio_map, by.x="id", by.y="polyID")
expected_ct_map <- ggplot() +
geom_polygon(
data=ohio_df,
aes(x=long, y=lat, group=group,
fill = exp_cut)) +
scale_fill_brewer("Expected deaths", palette="RdBu", direction=-1) +
theme(line=element_blank(),
axis.text=element_blank(),
axis.title=element_blank()) +
coord_equal()
#save the map
ggsave("ohio_map_exp_ggplot.pdf", width=8, height=8)
plot(expected_ct_map)
num_bins <- 8
quants <- round(quantile(ohio_map@data$Exp, seq(0,1,length.out=num_bins)),2)
ohio_map@data$exp_cut <- cut(ohio_map@data$Exp, breaks=c(quants, Inf), include.lowest=TRUE, right=FALSE)
ohio_df <- tidy(ohio_map)
ohio_map$polyID <- sapply(slot(ohio_map, "polygons"), function(x) slot(x, "ID"))
ohio_df <- merge(ohio_df, ohio_map, by.x="id", by.y="polyID")
expected_ct_map <- ggplot() +
geom_polygon(
data=ohio_df,
aes(x=long, y=lat, group=group,
fill = exp_cut)) +
scale_fill_brewer("Expected deaths", palette="RdBu", direction=-1) +
theme(line=element_blank(),
axis.text=element_blank(),
axis.title=element_blank()) +
coord_equal()
summary(ohio_map$smr)
summary(ohio_map$smr)
hist(ohio_map$smr)
summary(ohio_map$smr)
hist(ohio_map$smr, breaks=10)
ebresults <- eBayes(Y, E)
ebresults <- eBayes(Obs, Exp)
ebresults <- eBayes(ohio_map$Obs, ohio_map$Exp)
ebresults$alpha
exp(ebresults$beta)
mean(Obs/Exp, data=ohio_map)
mean(data=ohio_map, Obs/Exp)
mean(ohio_map$Obs/ohio_map$Exp)
summary(ebresults$RR)
ebresults <- eBayes(ohio_map$Obs, ohio_map$Exp)
ebresults$alpha
#alpha = 51.73209
exp(ebresults$beta)
#beta = 0.9749581
mean(ohio_map$Obs/ohio_map$Exp)
#mean is 0.9432857
summary(ebresults$RR)
par(mar = c(1,1,1,1))
mapvariable(ebresults$RR, ohio_map)
hist(ebresults$RR, breaks=10)
summary(ebresults$RR)
par(mfrow = c(1,2))
EBpostdens(ohio_map$Obs[1], ohio_map$Exp[1], ebresults$alpha, ebresults$beta,
lower = 0, upper = 15, main = "County 1")
EBpostdens(ohio_map$Obs[2], ohio_map$Exp[2], ebresults$alpha, ebresults$beta,
lower = 0, upper = 15, main = "County 1")
par(mfrow = c(1,2))
EBpostdens(ohio_map$Obs[1], ohio_map$Exp[1], ebresults$alpha, ebresults$beta,
lower = 0, upper = 15, main = "County 1")
EBpostdens(ohio_map$Obs[2], ohio_map$Exp[2], ebresults$alpha, ebresults$beta,
lower = 0, upper = 15, main = "County 2")
EBpostdens(ohio_map$Obs[3], ohio_map$Exp[3], ebresults$alpha, ebresults$beta,
lower = 0, upper = 15, main = "County 3")
EBpostdens(ohio_map$Obs[4], ohio_map$Exp[4], ebresults$alpha, ebresults$beta,
lower = 0, upper = 15, main = "County 4")
par(mfrow = c(1,4))
EBpostdens(ohio_map$Obs[1], ohio_map$Exp[1], ebresults$alpha, ebresults$beta,
lower = 0, upper = 15, main = "County 1")
EBpostdens(ohio_map$Obs[2], ohio_map$Exp[2], ebresults$alpha, ebresults$beta,
lower = 0, upper = 15, main = "County 2")
EBpostdens(ohio_map$Obs[3], ohio_map$Exp[3], ebresults$alpha, ebresults$beta,
lower = 0, upper = 15, main = "County 3")
EBpostdens(ohio_map$Obs[4], ohio_map$Exp[4], ebresults$alpha, ebresults$beta,
lower = 0, upper = 15, main = "County 4")
par(mfrow = c(2,2))
EBpostdens(ohio_map$Obs[1], ohio_map$Exp[1], ebresults$alpha, ebresults$beta,
lower = 0, upper = 15, main = "County 1")
EBpostdens(ohio_map$Obs[2], ohio_map$Exp[2], ebresults$alpha, ebresults$beta,
lower = 0, upper = 15, main = "County 2")
EBpostdens(ohio_map$Obs[3], ohio_map$Exp[3], ebresults$alpha, ebresults$beta,
lower = 0, upper = 15, main = "County 3")
EBpostdens(ohio_map$Obs[4], ohio_map$Exp[4], ebresults$alpha, ebresults$beta,
lower = 0, upper = 15, main = "County 4")
par(mfrow = c(2,2))
EBpostdens(ohio_map$Obs[1], ohio_map$Exp[1], ebresults$alpha, ebresults$beta,
lower = 0, upper = 5, main = "County 1")
EBpostdens(ohio_map$Obs[2], ohio_map$Exp[2], ebresults$alpha, ebresults$beta,
lower = 0, upper = 5, main = "County 2")
EBpostdens(ohio_map$Obs[3], ohio_map$Exp[3], ebresults$alpha, ebresults$beta,
lower = 0, upper = 5, main = "County 3")
EBpostdens(ohio_map$Obs[4], ohio_map$Exp[4], ebresults$alpha, ebresults$beta,
lower = 0, upper = 5, main = "County 4")
par(mfrow = c(2,2))
EBpostdens(ohio_map$Obs[1], ohio_map$Exp[1], ebresults$alpha, ebresults$beta,
lower = 0, upper = 3, main = "County 1")
EBpostdens(ohio_map$Obs[2], ohio_map$Exp[2], ebresults$alpha, ebresults$beta,
lower = 0, upper = 3, main = "County 2")
EBpostdens(ohio_map$Obs[3], ohio_map$Exp[3], ebresults$alpha, ebresults$beta,
lower = 0, upper = 3, main = "County 3")
EBpostdens(ohio_map$Obs[4], ohio_map$Exp[4], ebresults$alpha, ebresults$beta,
lower = 0, upper = 3, main = "County 4")
par(mfrow = c(2,2))
EBpostdens(ohio_map$Obs[1], ohio_map$Exp[1], ebresults$alpha, ebresults$beta,
lower = 0, upper = 3, main = "County 1")
EBpostdens(ohio_map$Obs[2], ohio_map$Exp[2], ebresults$alpha, ebresults$beta,
lower = 0, upper = 3, main = "County 2")
EBpostdens(ohio_map$Obs[3], ohio_map$Exp[3], ebresults$alpha, ebresults$beta,
lower = 0, upper = 3, main = "County 3")
EBpostdens(ohio_map$Obs[4], ohio_map$Exp[4], ebresults$alpha, ebresults$beta,
lower = 0, upper = 3, main = "County 4")
EBpostdens(ohio_map$Obs[88], ohio_map$Exp[88], ebresults$alpha, ebresults$beta,
lower = 0, upper = 3, main = "County 4")
par(mfrow = c(2,2))
EBpostdens(ohio_map$Obs[1], ohio_map$Exp[1], ebresults$alpha, ebresults$beta,
lower = 0, upper = 3, main = "County 1")
EBpostdens(ohio_map$Obs[2], ohio_map$Exp[2], ebresults$alpha, ebresults$beta,
lower = 0, upper = 3, main = "County 2")
EBpostdens(ohio_map$Obs[3], ohio_map$Exp[3], ebresults$alpha, ebresults$beta,
lower = 0, upper = 3, main = "County 3")
EBpostdens(ohio_map$Obs[4], ohio_map$Exp[4], ebresults$alpha, ebresults$beta,
lower = 0, upper = 3, main = "County 4")
par(mfrow = c(1,1), mar=c(1,1,1,1))
thresh_1.2 <- EBpostthresh(ohio_map$Obs, ohio_map$Exp, alpha = ebresults$alpha,
beta = ebresults$beta, rrthresh=1.2)
mapvariable(thresh_1.2, ohio_map)
egamma <- qgamma(seq(0.5, length(ohio_map$Obs), 1)/length(ohio_map$Obs),
ebresults$alpha, ebresults$alpha)
par(mfrow = c(1,2))
#first plot SMR estimates
plot(egamma, exp(-ebresults$beta) * sort(smr), xlim = c(0, 5), ylim = c(0, 5), xlab = "Exp Order Stat", ylab = "Obs Order Stat")
egamma <- qgamma(seq(0.5, length(ohio_map$Obs), 1)/length(ohio_map$Obs),
ebresults$alpha, ebresults$alpha)
par(mfrow = c(1,2))
#first plot SMR estimates
plot(egamma, exp(-ebresults$beta) * sort(ohio_map$smr), xlim = c(0, 5), ylim = c(0, 5), xlab = "Exp Order Stat", ylab = "Obs Order Stat")
abline(0,1)
#second plot is estimates from gamma model
plot(egamma, exp(-ebresults$beta) * sort(ebresults$RR),
xlim = c(0,5), ylim = c(0,5), xlab="Exp Order Stat",
ylab = "Obs Order Stat (Gamma)")
abline(0,1)
egamma <- qgamma(seq(0.5, length(ohio_map$Obs), 1)/length(ohio_map$Obs),
ebresults$alpha, ebresults$alpha)
par(mfrow = c(1,2))
#first plot SMR estimates
plot(egamma, exp(-ebresults$beta) * sort(ohio_map$smr), xlim = c(0, 2), ylim = c(0, 2), xlab = "Exp Order Stat", ylab = "Obs Order Stat")
abline(0,1)
#second plot is estimates from gamma model
plot(egamma, exp(-ebresults$beta) * sort(ebresults$RR),
xlim = c(0,2), ylim = c(0,2), xlab="Exp Order Stat",
ylab = "Obs Order Stat (Gamma)")
abline(0,1)
egamma <- qgamma(seq(0.5, length(ohio_map$Obs), 1)/length(ohio_map$Obs),
ebresults$alpha, ebresults$alpha)
par(mfrow = c(1,2))
#first plot SMR estimates
plot(egamma, exp(-ebresults$beta) * sort(ohio_map$smr), xlim = c(0.4, 1.6), ylim = c(0.4, 1.6), xlab = "Exp Order Stat", ylab = "Obs Order Stat")
abline(0,1)
#second plot is estimates from gamma model
plot(egamma, exp(-ebresults$beta) * sort(ebresults$RR),
xlim = c(0.4, 1.6), ylim = c(0.4, 1.6), xlab="Exp Order Stat",
ylab = "Obs Order Stat (Gamma)")
abline(0,1)
par(mfrow = c(1,2))
plot(SMRstar, ebresults$RR, xlab="SMR", ylab="EB estimates",
xlim = c(0, max(SMRstar)), ylim = c(0, max(SMRstar)),
pch = 4, col="purple")
par(mfrow = c(1,2))
plot(ohio_map$smr, ebresults$RR, xlab="SMR", ylab="EB estimates",
xlim = c(0, max(SMRstar)), ylim = c(0, max(SMRstar)),
pch = 4, col="purple")
par(mfrow = c(1,2))
plot(ohio_map$smr, ebresults$RR, xlab="SMR", ylab="EB estimates",
xlim = c(0, max(ohio_map$smr)), ylim = c(0, max(ohio_map$smr)),
pch = 4, col="purple")
abline(0,1)
par(mfrow = c(1,2))
plot(ohio_map$smr, ebresults$RR, xlab="SMR", ylab="EB estimates",
xlim = c(0, max(ohio_map$smr)), ylim = c(0, max(ohio_map$smr)),
pch = 2, col="purple")
abline(0,1)
par(mfrow = c(1,2))
plot(ohio_map$smr, ebresults$RR, xlab="SMR", ylab="EB estimates",
xlim = c(0, max(ohio_map$smr)), ylim = c(0, max(ohio_map$smr)),
pch = 1, col="purple")
abline(0,1)
par(mfrow = c(1,2))
plot(ohio_map$smr, ebresults$RR, xlab="SMR", ylab="EB estimates",
xlim = c(0.3, 1.7), ylim = c(0.3, 1.7),
pch = 1, col="purple")
abline(0,1)
par(mfrow = c(2,1))
plot(ohio_map$smr, ebresults$RR, xlab="SMR", ylab="EB estimates",
xlim = c(0.3, 1.7), ylim = c(0.3, 1.7),
pch = 1, col="purple")
abline(0,1)
par(mfrow = c(1,1))
plot(ohio_map$smr, ebresults$RR, xlab="SMR", ylab="EB estimates",
xlim = c(0.3, 1.7), ylim = c(0.3, 1.7),
pch = 1, col="purple")
abline(0,1)
par(mfrow = c(2,1))
plot(ohio_map$smr, ebresults$RR, xlab="SMR", ylab="EB estimates",
xlim = c(0.3, 1.7), ylim = c(0.3, 1.7),
pch = 1, col="purple")
abline(0,1)
plot(log(ohio_map$smr, log(ebresults$RR),
xlim= c(-3, 3), ylim = c(-3, 3),
xlab="log(SMR)", ylab="log(EB estimate)",
pch = 1, col="purple")
abline(0,1)
par(mfrow = c(2,1))
plot(ohio_map$smr, ebresults$RR, xlab="SMR", ylab="EB estimates",
xlim = c(0.3, 1.7), ylim = c(0.3, 1.7),
pch = 1, col="purple")
abline(0,1)
plot(log(ohio_map$smr), log(ebresults$RR),
xlim= c(-3, 3), ylim = c(-3, 3),
xlab="log(SMR)", ylab="log(EB estimate)",
pch = 1, col="purple")
abline(0,1)
#par(mfrow = c(2,1))
plot(ohio_map$smr, ebresults$RR, xlab="SMR", ylab="EB estimates",
xlim = c(0.3, 1.7), ylim = c(0.3, 1.7),
pch = 1, col="purple")
abline(0,1)
plot(log(ohio_map$smr), log(ebresults$RR),
xlim= c(-3, 3), ylim = c(-3, 3),
xlab="log(SMR)", ylab="log(EB estimate)",
pch = 1, col="purple")
abline(0,1)
#par(mfrow = c(2,1))
plot(ohio_map$smr, ebresults$RR, xlab="SMR", ylab="EB estimates",
xlim = c(0.3, 1.7), ylim = c(0.3, 1.7),
pch = 1, col="purple")
abline(0,1)
plot(log(ohio_map$smr), log(ebresults$RR),
xlim= c(-1.5, 1.5), ylim = c(-1, 1),
xlab="log(SMR)", ylab="log(EB estimate)",
pch = 1, col="purple")
abline(0,1)
lnprior <- LogNormalPriorCh(1,5,0.5,0.95)
lnprior
lnprior <- LogNormalPriorCh(1,5,0.5,0.95)
lnprior
plot(seq(0,7,0.1), dlnorm(seq(0,7,0.1),
meanlog=lnprior$mu, sdlog=lnprior$sigma),
type="1", xlab=expression(theta),
ylab="LogNormal Density")
lnprior <- LogNormalPriorCh(1,5,0.5,0.95)
lnprior
plot(seq(0,7,0.1), dlnorm(seq(0,7,0.1),
meanlog=lnprior$mu, sdlog=lnprior$sigma),
type="l", xlab=expression(theta),
ylab="LogNormal Density")
spplot(ohio_map, c("SMR"), at = c(0,0.25.0.5,0.8, 1, 1.5, 2.5, 4.5, 7), col.regions = rev(brewer.pal(8, "RdBu")))
spplot(ohio_map, c("SMR"), at = c(0,0.25,0.5,0.8, 1, 1.5, 2.5, 4.5, 7), col.regions = rev(brewer.pal(8, "RdBu")))
spplot(ohio_map, c("SMR"), at = c(0,0.25,0.5,0.8, 1, 1.5, 2.5, 4.5, 7), col.fips = rev(brewer.pal(8, "RdBu")))
spplot(ohio_map, c("smr"), at = c(0,0.25,0.5,0.8, 1, 1.5, 2.5, 4.5, 7), col.regions = rev(brewer.pal(8, "RdBu")))
spplot(ohio_map, c("smr"), at = c(0,0.2,0.4,0.6, 0.8, 1, 1.2, 1.4, 1.6), col.regions = rev(brewer.pal(8, "RdBu")))
pcprec <- list(theta = list(prior = "pc.prec",
param = c(1, 0.05)))
ohio.fit1 <- inla(Counts ~ 1 + f(fips,
model = "iid", hyper= pcprec), data = ohio_map,
family="poisson", E = Obs, control.predictor = list(compute))
pcprec <- list(theta = list(prior = "pc.prec",
param = c(1, 0.05)))
ohio.fit1 <- inla(Counts ~ 1 + f(fips,
model = "iid", hyper= pcprec), data = ohio_canc,
family="poisson", E = Obs, control.predictor = list(compute))
ohio_map2 <- as.data.frame(ohio_map)
pcprec <- list(theta = list(prior = "pc.prec",
param = c(1, 0.05)))
ohio.fit1 <- inla(Counts ~ 1 + f(fips,
model = "iid", hyper= pcprec), data = ohio_map,
family="poisson", E = Obs, control.predictor = list(computeAllLogLkhd()))
ohio_map2 <- as.data.frame(ohio_map)
pcprec <- list(theta = list(prior = "pc.prec",
param = c(1, 0.05)))
ohio.fit1 <- inla(Counts ~ 1 + f(fips,
model = "iid", hyper= pcprec), data = ohio_map2,
family="poisson", E = Obs, control.predictor = list(computeAllLogLkhd()))
ohio_map2 <- as.data.frame(ohio_map)
pcprec <- list(theta = list(prior = "pc.prec",
param = c(1, 0.05)))
ohio.fit1 <- inla(Counts ~ 1 + f(fips,
model = "iid", hyper= pcprec), data = ohio_map2,
family="poisson", E = Obs, control.predictor = list(compute))
ohio_map2 <- as.data.frame(ohio_map)
pcprec <- list(theta = list(prior = "pc.prec",
param = c(1, 0.05)))
ohio.fit1 <- inla(Counts ~ 1 + f(fips,
model = "iid", hyper= pcprec), data = ohio_map2,
family="poisson", E = Obs, control.predictor = list(compute=TRUE))
ohio_map2 <- as.data.frame(ohio_map)
pcprec <- list(theta = list(prior = "pc.prec",
param = c(1, 0.05)))
ohio.fit1 <- inla(Obs ~ 1 + f(fips,
model = "iid", hyper= pcprec), data = ohio_map2,
family="poisson", E = E, control.predictor = list(compute=TRUE))
ohio_map2 <- as.data.frame(ohio_map)
pcprec <- list(theta = list(prior = "pc.prec",
param = c(1, 0.05)))
ohio.fit1 <- inla(Obs ~ 1 + f(fips,
model = "iid", hyper= pcprec), data = ohio_map2,
family="poisson", E = Exp, control.predictor = list(compute=TRUE))
ohio_map2 <- as.data.frame(ohio_map)
pcprec <- list(theta = list(prior = "pc.prec"))
ohio.fit1 <- inla(Obs ~ 1 + f(fips,
model = "iid", hyper= pcprec), data = ohio_map2,
family="poisson", E = Exp, control.predictor = list(compute=TRUE))
ohio_map2 <- as.data.frame(ohio_map)
pcprec <- list(theta = list(prior = "pc.prec",
param = c(1, 0.05)))
ohio.fit1 <- inla(Obs ~ 1 + f(fips,
model = "iid", hyper= pcprec), data = ohio_map2,
family="poisson", E = Exp, control.predictor = list(compute=TRUE))
summary(ohio_fit1)
ohio_map2 <- as.data.frame(ohio_map)
pcprec <- list(theta = list(prior = "pc.prec",
param = c(1, 0.05)))
ohio.fit1 <- inla(Obs ~ 1 + f(fips,
model = "iid", hyper= pcprec), data = ohio_map2,
family="poisson", E = Exp, control.predictor = list(compute=TRUE))
summary(ohio_fit1)
ohio_map2 <- as.data.frame(ohio_map)
pcprec <- list(theta = list(prior = "pc.prec",
param = c(1, 0.05)))
ohio.fit1 <- inla(Obs ~ 1 + f(fips,
model = "iid", hyper= pcprec), data = ohio_map2,
family="poisson", E = Exp, control.predictor = list(compute=TRUE))
summary(ohio.fit1)
ohio_map2 <- as.data.frame(ohio_map)
pcprec <- list(theta = list(prior = "pc.prec",
param = c(1, 0.05)))
ohio.fit1 <- inla(Obs ~ 1 + f(fips,
model = "iid", hyper= pcprec), data = ohio_map2,
family="poisson", E = Exp, control.predictor = list(compute=TRUE))
summary(ohio.fit1)
expbetaOmed <- ohio.fit1$summary.fixed[4]
sdmed <- 1/sqrt(ohio.fit1$summary.hyperpar[4])
expbetaOmed <- ohio.fit1$summary.fixed[4]
sdmed <- 1/sqrt(ohio.fit1$summary.hyperpar[4])
expbetaOmed
sdmed
lnorminter <- ohio.fit1$summary.fixed[4]
lnormREs <- exp(ohio.fit1$summary.random$fips[5])
ohio_map$RRlnorm <- lnormRRs
lnorminter <- ohio.fit1$summary.fixed[4]
lnormRRs <- exp(ohio.fit1$summary.random$fips[5])
ohio_map$RRlnorm <- lnormRRs
spplot(ohio_map, c("RRlnorm"), col.regions=colorRampPalette((rev(brewer.pal(8, "RdBu")))(50))
lnorminter <- ohio.fit1$summary.fixed[4]
lnormRRs <- exp(ohio.fit1$summary.random$fips[5])
ohio_map$RRlnorm <- lnormRRs
spplot(ohio_map, c("RRlnorm"), col.regions=colorRampPalette(rev(brewer.pal(8, "RdBu")))(50))
lnorminter <- ohio.fit1$summary.fixed[4]
lnormRRs <- exp(ohio.fit1$summary.random$fips[5])
ohio_map2$RRlnorm <- lnormRRs
spplot(ohio_map2, c("RRlnorm"), col.regions=colorRampPalette(rev(brewer.pal(8, "RdBu")))(50))
ohio_map$RRlnorm <- lnormRRs
spplot(ohio_map, c("RRlnorm"), col.regions=colorRampPalette(rev(brewer.pal(8, "RdBu")))(50))
View(ohio_map)
lnorminter <- ohio.fit1$summary.fixed[4]
lnormRRs <- exp(ohio.fit1$summary.random$fips[5])
ohio_map2$RRlnorm <- lnormRRs
spplot(ohio_map2, c("RRlnorm"), col.regions=colorRampPalette(rev(brewer.pal(8, "RdBu")))(50))
View(ohio_map2)
summary(ohio.fit1)
lnorminter <- ohio.fit1$summary.fixed[4]
lnormRRs <- exp(ohio.fit1$summary.random$fips[5])
ohio_map2$RRlnorm <- lnormRRs
spplot(ohio_map2, c("RRlnorm"), col.regions=colorRampPalette(rev(brewer.pal(8, "RdBu")))(50))
#summary(ohio.fit1)
lnorminter <- ohio.fit1$summary.fixed[4]
lnormREs <- exp(ohio.fit1$summary.random$fips[5])
lnormRRs <- as.double(exp(lnorminter)) * lnormREs[,1]
ohio_map$RRlnorm <- lnormRRs
spplot(ohio_map, c("RRlnorm"), col.regions=colorRampPalette(rev(brewer.pal(8, "RdBu")))(50))
#summary(ohio.fit1)
lnorminter <- ohio.fit1$summary.fixed[4]
lnormREs <- exp(ohio.fit1$summary.random$fips[5])
lnormRRs <- as.double(exp(lnorminter)) * lnormREs[,1]
ohio_map2$RRlnorm <- lnormRRs
spplot(ohio_map2, c("RRlnorm"), col.regions=colorRampPalette(rev(brewer.pal(8, "RdBu")))(50))
#summary(ohio.fit1)
lnorminter <- ohio.fit1$summary.fixed[4]
lnormREs <- exp(ohio.fit1$summary.random$fips[5])
lnormRRs <- as.double(exp(lnorminter)) * lnormREs[,1]
ohio_map$RRlnorm <- lnormRRs
spplot(ohio_map, c("RRlnorm"), col.regions=colorRampPalette(rev(brewer.pal(8, "RdBu")))(50))
names(ohio.fit1)
ohio.fit1$summary.fixed
#summary(ohio.fit1)
ohio.fit1$summary.fixed
lnorminter <- ohio.fit1$summary.fixed[4]
lnormREs <- exp(ohio.fit1$summary.random$Region[5])
#summary(ohio.fit1)
ohio.fit1$summary.fixed
lnorminter <- ohio.fit1$summary.fixed[4]
lnormREs <- exp(ohio.fit1$summary.random$fips[5])
lnormRRs <- as.double(exp(lnorminter)) * lnormREs[,1]
ohio_map$RRlnorm <- lnormRRs
spplot(ohio_map, c("RRlnorm"), col.regions=colorRampPalette(rev(brewer.pal(8, "RdBu")))(50))
par(mfrow = c(1,2))
plot(ohio_map$smr, ebresults$RR, xlab="SMR", ylab="EB estimates",
xlim = c(0.3, 1.7), ylim = c(0.3, 1.7),
pch = 1, col="purple")
abline(0,1)
par(mfrow = c(1,1))
plot(ohio_map$RRlnorm, ohio_map$smr, xlab="SMR", ylab="Lognormal estimates",
xlim = c(0,5), ylim = c(0,5),
pch=1, col="purple")
abline(o,1)
par(mfrow = c(1,1))
plot(ohio_map$RRlnorm, ohio_map$smr, xlab="SMR", ylab="Lognormal estimates",
xlim = c(0,5), ylim = c(0,5),
pch=1, col="purple")
abline(0,1)
plot(ohio_map$RRlnorm, ebresults$RR, xlab="SMR", ylab="EB estimates",
xlim = c(0.3, 1.7), ylim = c(0.3, 1.7),
pch = 1, col="purple")
abline(0,1)
par(mfrow = c(1,1))
plot(ohio_map$RRlnorm, ohio_map$smr, xlab="SMR", ylab="Lognormal estimates",
xlim = c(0,2), ylim = c(0,2),
pch=1, col="purple")
abline(0,1)
plot(ohio_map$RRlnorm, ebresults$RR, xlab="SMR", ylab="EB estimates",
xlim = c(0.3, 1.7), ylim = c(0.3, 1.7),
pch = 1, col="purple")
abline(0,1)
ohio_map2 <- as.data.frame(ohio_map)
pcprec <- list(theta = list(prior = "pc.prec",
param = c(1, 0.05)))
ohio.fit1 <- inla(Obs ~ 1 + f(fips,
model = "iid", hyper= pcprec), data = ohio_map,
family="poisson", E = Exp, control.predictor = list(compute=TRUE))
ohio_map2 <- as.data.frame(ohio_map)
pcprec <- list(theta = list(prior = "pc.prec",
param = c(1, 0.05)))
ohio.fit1 <- inla(Obs ~ 1 + f(fips,
model = "iid", hyper= pcprec), data = ohio_map2,
family="poisson", E = Exp, control.predictor = list(compute=TRUE))
summary(ohio.fit1)
names(ohio.fit1)
expbetaOmed <- ohio.fit1$summary.fixed[4]
sdmed <- 1/sqrt(ohio.fit1$summary.hyperpar[4])
expbetaOmed
sdmed
ohio_map2 <- as.data.frame(ohio_map)
pcprec <- list(theta = list(prior = "pc.prec"))
ohio.fit1 <- inla(Obs ~ 1 + f(fips,
model = "iid", hyper= pcprec), data = ohio_map2,
family="poisson", E = Exp, control.predictor = list(compute=TRUE))
summary(ohio.fit1)
names(ohio.fit1)
expbetaOmed <- ohio.fit1$summary.fixed[4]
sdmed <- 1/sqrt(ohio.fit1$summary.hyperpar[4])
expbetaOmed
sdmed
#summary(ohio.fit1)
ohio.fit1$summary.fixed
lnorminter <- ohio.fit1$summary.fixed[4]
lnormREs <- exp(ohio.fit1$summary.random$fips[5])
lnormRRs <- as.double(exp(lnorminter)) * lnormREs[,1]
ohio_map$RRlnorm <- lnormRRs
spplot(ohio_map, c("RRlnorm"), col.regions=colorRampPalette(rev(brewer.pal(8, "RdBu")))(50))
